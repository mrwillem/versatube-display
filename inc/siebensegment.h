#ifndef SIEBENSEGMENT_H
#define SIEBENSEGMENT_H

#include "hw_config.h"

void siebensegment_config(void);
void siebensegment_init(void);
uint8_t siebensegment_send_data(uint8_t, uint8_t, uint8_t);
void siebensegment_send_number(uint8_t);
uint8_t asciitocharacter(uint8_t);

const uint8_t characters[38];


#define SIEBENSEGMENT_PERIPH RCC_APB2Periph_GPIOC

#define SIEBENSEGMENT_CS_PIN GPIO_Pin_4
#define SIEBENSEGMENT_CS_GPIO_PORT GPIOC



#define SIEBENSEGMENT_CMD_NOOP 0x00
#define SIEBENSEGMENT_CMD_DIGIT1 0x01
#define SIEBENSEGMENT_CMD_DIGIT2 0x02
#define SIEBENSEGMENT_CMD_DIGIT3 0x03
#define SIEBENSEGMENT_CMD_DIGIT4 0x04
#define SIEBENSEGMENT_CMD_DECMODE 0x09
#define SIEBENSEGMENT_CMD_INTCTRL 0x0A
#define SIEBENSEGMENT_CMD_SCANLIM 0x0B
#define SIEBENSEGMENT_CMD_SHDOWN 0x0C
#define SIEBENSEGMENT_CMD_FEATURE 0x0E
#define SIEBENSEGMENT_CMD_TEST 0x0F

/* Subcommands, the second byte to be transfered after the command above */
#define SIEBENSEGMENT_SCANLIM1 0x00
#define SIEBENSEGMENT_SCANLIM12 0x01
#define SIEBENSEGMENT_SCANLIM123 0x02
#define SIEBENSEGMENT_SCANLIM1234 0x03

#define SIEBENSEGMENT_TEST_ON 0x01
#define SIEBENSEGMENT_TEST_OFF 0x00

#define SIEBENSEGMENT_FEATURE_CLKSEL_INT   0b00000000
#define SIEBENSEGMENT_FEATURE_CLKSEL_EXT   0b00000001
#define SIEBENSEGMENT_FEATURE_RESET_OFF    0b00000000
#define SIEBENSEGMENT_FEATURE_RESET_ON 	   0b00000010
#define SIEBENSEGMENT_FEATURE_DECODE_CODEB 0b00000000
#define SIEBENSEGMENT_FEATURE_DECODE_HEX   0b00000100
#define SIEBENSEGMENT_FEATURE_IF_DEF       0b00000000
#define SIEBENSEGMENT_FEATURE_IF_SPI       0b00001000
#define SIEBENSEGMENT_FEATURE_BLINK_OFF    0b00000000
#define SIEBENSEGMENT_FEATURE_BLINK_ON     0b00010000
#define SIEBENSEGMENT_FEATURE_BLINK_1S     0b00000000
#define SIEBENSEGMENT_FEATURE_BLINK_2S     0b00100000
#define SIEBENSEGMENT_FEATURE_BLINK_ASYNC  0b00000000
#define SIEBENSEGMENT_FEATURE_BLINK_SYNC   0b01000000
#define SIEBENSEGMENT_FEATURE_STARTBL_OFF  0b00000000
#define SIEBENSEGMENT_FEATURE_STARTBL_ON   0b10000000


#define SIEBENSEGMENT_SHDOWN_SHDOWN_RESET   0x00
#define SIEBENSEGMENT_SHDOWN_SHDOWN_FEATURE 0x80
#define SIEBENSEGMENT_SHDOWN_NORMAL_RESET   0x01
#define SIEBENSEGMENT_SHDOWN_NORMAL_FEATURE 0x81

#define SIEBENSEGMENT_DECMODE_NODEC 0x00
#define SIEBENSEGMENT_DECMODE_DIG123 0x01
#define SIEBENSEGMENT_DECMODE_DIG1234 0xFF








#endif //SIEBENSEGMENT_H
